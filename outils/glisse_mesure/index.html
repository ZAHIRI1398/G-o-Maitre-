<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Glisse Mesure</title>
    <style>
        canvas {
            border: 1px solid black;
            margin: 10px;
        }
        .controls {
            margin: 10px;
        }
        input[type="number"] {
            width: 60px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <input type="number" id="mesure" value="0" min="0" max="100" step="1">
        <button id="reset">Réinitialiser</button>
    </div>
    <canvas id="canvas" width="400" height="100"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const mesureInput = document.getElementById('mesure');
        const resetBtn = document.getElementById('reset');

        let isDragging = false;
        let startX = 0;
        let currentX = 0;

        function drawRuler() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Dessiner la règle
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(350, 50);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Dessiner les graduations
            for(let i = 0; i <= 100; i++) {
                const x = 50 + (i * 3);
                const height = i % 10 === 0 ? 15 : (i % 5 === 0 ? 10 : 5);
                
                ctx.beginPath();
                ctx.moveTo(x, 50 - height/2);
                ctx.lineTo(x, 50 + height/2);
                ctx.stroke();

                if(i % 10 === 0) {
                    ctx.fillText(i, x - 3, 70);
                }
            }

            // Dessiner le curseur
            const cursorX = 50 + (mesureInput.value * 3);
            ctx.beginPath();
            ctx.moveTo(cursorX, 30);
            ctx.lineTo(cursorX - 5, 20);
            ctx.lineTo(cursorX + 5, 20);
            ctx.closePath();
            ctx.fillStyle = 'red';
            ctx.fill();
        }

        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            if(x >= 50 && x <= 350) {
                isDragging = true;
                startX = x;
                currentX = x;
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if(isDragging) {
                const rect = canvas.getBoundingClientRect();
                currentX = e.clientX - rect.left;
                const value = Math.max(0, Math.min(100, Math.round((currentX - 50) / 3)));
                mesureInput.value = value;
                drawRuler();
            }
        });

        canvas.addEventListener('mouseup', () => {
            isDragging = false;
        });

        mesureInput.addEventListener('input', () => {
            drawRuler();
        });

        resetBtn.addEventListener('click', () => {
            mesureInput.value = 0;
            drawRuler();
        });

        drawRuler();
    </script>
</body>
</html>
